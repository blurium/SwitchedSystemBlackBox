% !TEX root = main.tex
In this section, we show that using the Property \ref{property:convpres} and Property \ref{property:homogeneity}, by sampling finitely many points on a level set of a candidate CQLF, we can compute an upper bound on $\rho$. The main theorem in this section which formalizes this is based on the following theorem, whose proof we devote most of this section:

\begin{theorem} \label{thm:mainTheorem0} Let $\epsilon \in (0,1]$. For a given a sampling of the switched linear system \eqref{eq:switchedSystem}, $\omega_N$ and $\beta \in [0,1)$, we can compute $\delta(\beta, \omega_N) < \infty$ such that:
\begin{equation}E_{\delta^2P} \subset  \convhull (E_P \setminus V_{P}), \, \text{where} \mu(tV_P) = \epsilon,
\end{equation}
for some $P \succ 0$.
\end{theorem}

Before proving Theorem \ref{thm:mainTheorem0}, we prove the main result of this section

\begin{theorem}[Main Theorem] \label{thm:mainTheorem} For a given a sampling of the switched linear system \eqref{eq:switchedSystem}, $\omega_N$, where $N \geq d+1$ and $\beta \in [0,1)$, we can compute $\delta(\beta, \omega_N) < \infty$ such that with probability at least $\beta$, $\rho \leq \frac{\gamma^*(\omega_N)}{\delta}$. Moreover, $\lim_{N \to \infty} \delta(N) = 1$.
\end{theorem}
%\begin{theorem}
%Consider a black-box switching system and $N$ samples of its dynamics as in \eqref{eq:switchedSystem}. Consider the optimal solution $(\lambda^*,P)$ which minimizes $\lambda$ in \eqref{eq:lowerbound}. For any factor $1<\delta,$ one can compute the level of confidence $\beta$ such that $\rho<\delta\cdot\lambda^*.$ 
%% denote $\gamma(P,\epsilon)$ the largest $\gamma$ such that $\gamma^2y_i^TPy_i\leq x_i^TPx_i$ 
%\end{theorem}
\begin{proof}
Fix $\delta<1$ and denote $E_P$ the ellipsoid described by $P$ (i.e., $\{x:x^TPx= 1\}$), and denote $\epsilon$ such that for any subset $S_\epsilon$ of measure $\epsilon,$ 
$$ E_{\delta^2P} \subset  \convhull (E_P\setminus S_\epsilon) .$$ 
  	
Now, denoting $N$ the number of observations available, compute $0< \beta< 1$ such that $$N=N(\epsilon,\beta)$$ in Theorem \ref{thm:campi} above. 

Summarizing, the equation above means that with high probability, one has that \eqref{eq:lowerbound} is satisfied for all $x\in \re^n,$ except for a set of measure $\epsilon.$  Let us denote $S_\epsilon$ this set of violated constraints.  Thus, $$(\cM/\lambda^*) \convhull (E_P\setminus S_\epsilon) \subset \convhull (E_P\setminus S_\epsilon).$$  Now, by definition of $\epsilon,$ one has

$$ E_{\delta^2P} \subset  \convhull (E_P\setminus S_\epsilon) ,$$ and so
$$
(\cM/\delta \lambda^*) \convhull (E_P \setminus S_\epsilon) \subset \convhull (E_P\setminus S_\epsilon).$$

Then, $\delta\lambda$ is un upper bound on $\rho,$ with a confidence $\beta.$ 
\end{proof}